Bootstrap: docker
From: continuumio/miniconda3:latest

%labels
    Author HYMET developers
    Description "Singularity definition mirroring the HYMET Docker image"

%files
    environment.yml /tmp/environment.yml
    . /workspace

%post
    set -e
    export DEBIAN_FRONTEND=noninteractive
    apt-get update && apt-get install -y perl wget && rm -rf /var/lib/apt/lists/*
    conda env create -f /tmp/environment.yml

%environment
    export PATH=/opt/conda/envs/hymet_env/bin:$PATH
    export HYMET_ROOT=/workspace

%runscript
    exec "$@"

